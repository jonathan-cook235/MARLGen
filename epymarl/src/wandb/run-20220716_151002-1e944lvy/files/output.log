about to run
setting up runner
namespace(action_selector='epsilon_greedy', add_value_last_step=True, agent='rnn', agent_output_type='q', batch_size=10, batch_size_run=1, buffer_cpu_only=True, buffer_size=5000, checkpoint_path='', critic_type='ac_critic', device='cpu', double_q=True, entropy_coef=0.01, env='griddlygen', env_args={'seed': 8867, 'level_seeds': array([8381, 7559, 6543, ..., 6025, 4096, 8964])}, epochs=4, eps_clip=0.2, epsilon_anneal_time=5000, epsilon_finish=0.05, epsilon_start=1.0, evaluate=False, evaluation_epsilon=0.0, gamma=0.99, grad_norm_clip=10, hidden_dim=64, hypergroup=None, hypernet_embed=64, hypernet_layers=2, label='default_label', learner='q_learner', learner_log_interval=10000, load_step=0, local_results_path='results', log_interval=10000, lr=0.0005, mac='basic_mac', mask_before_softmax=True, max_before_softmax=True, mixer='qmix', mixing_embed_dim=32, name='qmix', obs_agent_id=True, obs_individual_obs=False, obs_last_action=False, optim_alpha=0.99, optim_eps=1e-05, q_nstep=5, repeat_id=1, runner='episode', runner_log_interval=1000, save_model=False, save_model_interval=50000, save_replay=False, seed=8867, standardise_returns=False, standardise_rewards=True, t_max=20050000, target_update_interval_or_tau=200, test_greedy=True, test_interval=50000, test_nepisode=100, unique_token='qmix_seed8867_Griddly_2022-07-16 15:10:09.584292', use_cuda=False, use_rnn=False, use_tensorboard=False)
KWARGS
{'seed': 8867, 'level_seeds': array([8381, 7559, 6543, ..., 6025, 4096, 8964])}
[2022-07-16 15:10:09.612] [info] No level specified, will use the first level described in the GDY.
got runner
[WARNING 15:10:09] my_main CUDA flag use_cuda was switched OFF automatically because no CUDA devices are available!
[INFO 15:10:09] my_main Experiment Parameters:
[INFO 15:10:09] my_main
{   'action_selector': 'epsilon_greedy',
    'add_value_last_step': True,
    'agent': 'rnn',
    'agent_output_type': 'q',
    'batch_size': 10,
    'batch_size_run': 1,
    'buffer_cpu_only': True,
    'buffer_size': 5000,
    'checkpoint_path': '',
    'critic_type': 'ac_critic',
    'double_q': True,
    'entropy_coef': 0.01,
    'env': 'griddlygen',
    'env_args': {   'level_seeds': array([8381, 7559, 6543, ..., 6025, 4096, 8964]),
                    'seed': 8867},
    'epochs': 4,
    'eps_clip': 0.2,
    'epsilon_anneal_time': 5000,
    'epsilon_finish': 0.05,
    'epsilon_start': 1.0,
    'evaluate': False,
    'evaluation_epsilon': 0.0,
    'gamma': 0.99,
    'grad_norm_clip': 10,
    'hidden_dim': 64,
    'hypergroup': None,
    'hypernet_embed': 64,
    'hypernet_layers': 2,
    'label': 'default_label',
    'learner': 'q_learner',
    'learner_log_interval': 10000,
    'load_step': 0,
    'local_results_path': 'results',
    'log_interval': 10000,
    'lr': 0.0005,
    'mac': 'basic_mac',
    'mask_before_softmax': True,
    'max_before_softmax': True,
    'mixer': 'qmix',
    'mixing_embed_dim': 32,
    'name': 'qmix',
    'obs_agent_id': True,
    'obs_individual_obs': False,
    'obs_last_action': False,
    'optim_alpha': 0.99,
    'optim_eps': 1e-05,
    'q_nstep': 5,
    'repeat_id': 1,
    'runner': 'episode',
    'runner_log_interval': 1000,
    'save_model': False,
    'save_model_interval': 50000,
    'save_replay': False,
    'seed': 8867,
    'standardise_returns': False,
    'standardise_rewards': True,
    't_max': 20050000,
    'target_update_interval_or_tau': 200,
    'test_greedy': True,
    'test_interval': 50000,
    'test_nepisode': 100,
    'use_cuda': False,
    'use_rnn': False,
    'use_tensorboard': False}
[INFO 15:10:09] my_main Beginning training for 40000 episodes
/Users/jonnycook/Desktop/MARLGen/epymarl/src/components/episode_buffer.py:108: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  ../torch/csrc/utils/tensor_new.cpp:201.)
  v = th.tensor(v, dtype=dtype, device=self.device)
/Users/jonnycook/Desktop/MARLGen/epymarl/src/components/episode_buffer.py:108: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  v = th.tensor(v, dtype=dtype, device=self.device)
[INFO 15:10:10] my_main t_env: 50 / 20050000
[INFO 15:10:10] my_main Estimated time left: 1 minutes, 3 seconds. Time passed: 0 seconds
[INFO 15:10:29] my_main Recent Stats | t_env:      10041 | Episode:      202
epsilon:                   0.0500	grad_norm:                 2.0080	loss:                      1.0018	q_taken_mean:             -0.0059
return_mean:               0.2200	return_std:                0.5521	target_mean:               0.0294	td_error_abs:              0.7684
test_return_mean:         -0.0300	test_return_std:           0.1706	
[INFO 15:10:44] my_main Recent Stats | t_env:      20041 | Episode:      402
epsilon:                   0.0500	grad_norm:                 6.0042	loss:                      0.8917	q_taken_mean:              0.0970
return_mean:               0.3600	return_std:                0.5742	target_mean:               0.2027	td_error_abs:              0.6651
test_return_mean:         -0.0300	test_return_std:           0.1706	
[INFO 15:10:59] my_main Recent Stats | t_env:      30041 | Episode:      602
epsilon:                   0.0500	grad_norm:                 5.9452	loss:                      0.7221	q_taken_mean:              0.1710
return_mean:               0.3000	return_std:                0.5040	target_mean:               0.2744	td_error_abs:              0.5918
test_return_mean:         -0.0300	test_return_std:           0.1706	
[INFO 15:11:14] my_main Recent Stats | t_env:      40041 | Episode:      802
epsilon:                   0.0500	grad_norm:                 5.9686	loss:                      0.7141	q_taken_mean:              0.2304
return_mean:               0.5300	return_std:                0.7138	target_mean:               0.3086	td_error_abs:              0.6104
test_return_mean:         -0.0300	test_return_std:           0.1706	
[INFO 15:11:29] my_main Recent Stats | t_env:      50041 | Episode:     1002
epsilon:                   0.0500	grad_norm:                 6.4671	loss:                      0.6503	q_taken_mean:              0.2415
return_mean:               0.4500	return_std:                0.6918	target_mean:               0.3234	td_error_abs:              0.5737
test_return_mean:         -0.0300	test_return_std:           0.1706	
Episode: 1000
[INFO 15:11:29] my_main t_env: 50091 / 20050000
[INFO 15:11:29] my_main Estimated time left: 8 hours, 48 minutes, 29 seconds. Time passed: 1 minutes, 19 seconds
[INFO 15:11:48] my_main Recent Stats | t_env:      60041 | Episode:     1202
epsilon:                   0.0500	grad_norm:                19.4829	loss:                      1.2108	q_taken_mean:              0.4258
return_mean:               0.7400	return_std:                0.8738	target_mean:               0.6115	td_error_abs:              0.6645
test_return_mean:          0.1150	test_return_std:           0.3263	
[INFO 15:12:03] my_main Recent Stats | t_env:      70041 | Episode:     1402
epsilon:                   0.0500	grad_norm:                26.0122	loss:                      1.3690	q_taken_mean:              0.6099
return_mean:               0.6300	return_std:                0.7665	target_mean:               0.8114	td_error_abs:              0.7314
test_return_mean:          0.1150	test_return_std:           0.3263	
[INFO 15:12:18] my_main Recent Stats | t_env:      80041 | Episode:     1602
epsilon:                   0.0500	grad_norm:                35.9833	loss:                      1.6943	q_taken_mean:              0.7400
return_mean:               0.6800	return_std:                0.8198	target_mean:               1.0118	td_error_abs:              0.8689
test_return_mean:          0.1150	test_return_std:           0.3263	
[INFO 15:12:33] my_main Recent Stats | t_env:      90041 | Episode:     1802
epsilon:                   0.0500	grad_norm:                44.5658	loss:                      1.9696	q_taken_mean:              0.8939
return_mean:               0.8000	return_std:                0.8406	target_mean:               1.2180	td_error_abs:              0.9087
test_return_mean:          0.1150	test_return_std:           0.3263	
[INFO 15:12:48] my_main Recent Stats | t_env:     100041 | Episode:     2002
epsilon:                   0.0500	grad_norm:                56.7307	loss:                      2.4411	q_taken_mean:              0.9584
return_mean:               0.9700	return_std:                0.9285	target_mean:               1.3322	td_error_abs:              1.0393
test_return_mean:          0.1150	test_return_std:           0.3263	
[INFO 15:12:48] my_main t_env: 100091 / 20050000
[INFO 15:12:48] my_main Estimated time left: 8 hours, 47 minutes, 17 seconds. Time passed: 2 minutes, 38 seconds
Episode: 2000
[INFO 15:13:08] my_main Recent Stats | t_env:     110041 | Episode:     2202
epsilon:                   0.0500	grad_norm:                54.4682	loss:                      2.1997	q_taken_mean:              0.9663
return_mean:               1.1800	return_std:                0.8718	target_mean:               1.2778	td_error_abs:              1.0129
test_return_mean:          0.2533	test_return_std:           0.4646	
[INFO 15:13:23] my_main Recent Stats | t_env:     120041 | Episode:     2402
epsilon:                   0.0500	grad_norm:                53.5546	loss:                      2.1322	q_taken_mean:              1.0967
return_mean:               1.0500	return_std:                0.9080	target_mean:               1.3997	td_error_abs:              0.9783
test_return_mean:          0.2533	test_return_std:           0.4646	
[INFO 15:13:38] my_main Recent Stats | t_env:     130041 | Episode:     2602
epsilon:                   0.0500	grad_norm:                55.9920	loss:                      2.2275	q_taken_mean:              1.2003
return_mean:               1.2400	return_std:                1.1171	target_mean:               1.4564	td_error_abs:              0.9783
test_return_mean:          0.2533	test_return_std:           0.4646	
[INFO 15:13:53] my_main Recent Stats | t_env:     140041 | Episode:     2802
epsilon:                   0.0500	grad_norm:                61.8878	loss:                      2.4023	q_taken_mean:              1.4302
return_mean:               1.4500	return_std:                1.1347	target_mean:               1.7124	td_error_abs:              1.0364
test_return_mean:          0.2533	test_return_std:           0.4646	
Episode: 3000
[INFO 15:14:07] my_main Recent Stats | t_env:     150041 | Episode:     3002
epsilon:                   0.0500	grad_norm:                75.5253	loss:                      2.8526	q_taken_mean:              1.7528
return_mean:               1.5000	return_std:                1.0474	target_mean:               2.0932	td_error_abs:              1.1330
test_return_mean:          0.2533	test_return_std:           0.4646	
[INFO 15:14:08] my_main t_env: 150091 / 20050000
[INFO 15:14:08] my_main Estimated time left: 8 hours, 46 minutes, 45 seconds. Time passed: 3 minutes, 58 seconds
[INFO 15:14:27] my_main Recent Stats | t_env:     160041 | Episode:     3202
epsilon:                   0.0500	grad_norm:                81.6394	loss:                      2.8587	q_taken_mean:              2.1457
return_mean:               1.3500	return_std:                1.1240	target_mean:               2.5011	td_error_abs:              1.1446
test_return_mean:          0.4425	test_return_std:           0.6279	
[INFO 15:14:42] my_main Recent Stats | t_env:     170041 | Episode:     3402
epsilon:                   0.0500	grad_norm:                96.3994	loss:                      3.4355	q_taken_mean:              2.3643
return_mean:               1.6400	return_std:                1.1736	target_mean:               2.7500	td_error_abs:              1.2776
test_return_mean:          0.4425	test_return_std:           0.6279	
[INFO 15:14:57] my_main Recent Stats | t_env:     180041 | Episode:     3602
epsilon:                   0.0500	grad_norm:               104.9924	loss:                      3.7989	q_taken_mean:              2.7316
return_mean:               1.7200	return_std:                1.2304	target_mean:               3.1366	td_error_abs:              1.3200
test_return_mean:          0.4425	test_return_std:           0.6279	
[INFO 15:15:12] my_main Recent Stats | t_env:     190041 | Episode:     3802
epsilon:                   0.0500	grad_norm:                96.2944	loss:                      3.9770	q_taken_mean:              3.0912
return_mean:               1.8100	return_std:                1.1859	target_mean:               3.4241	td_error_abs:              1.3148
test_return_mean:          0.4425	test_return_std:           0.6279	
Episode: 4000
[INFO 15:15:27] my_main Recent Stats | t_env:     200041 | Episode:     4002
epsilon:                   0.0500	grad_norm:                95.1886	loss:                      4.4061	q_taken_mean:              4.0389
return_mean:               1.9300	return_std:                1.1678	target_mean:               4.3298	td_error_abs:              1.3364
test_return_mean:          0.4425	test_return_std:           0.6279	
[INFO 15:15:27] my_main t_env: 200091 / 20050000
[INFO 15:15:27] my_main Estimated time left: 8 hours, 45 minutes, 47 seconds. Time passed: 5 minutes, 17 seconds
[INFO 15:15:47] my_main Recent Stats | t_env:     210041 | Episode:     4202
epsilon:                   0.0500	grad_norm:               113.0637	loss:                      5.3910	q_taken_mean:              4.5639
return_mean:               1.8700	return_std:                1.1679	target_mean:               4.9072	td_error_abs:              1.4853
test_return_mean:          0.6780	test_return_std:           0.7282	
[INFO 15:16:02] my_main Recent Stats | t_env:     220078 | Episode:     4403
epsilon:                   0.0500	grad_norm:               105.7313	loss:                      5.8613	q_taken_mean:              5.2532
return_mean:               1.8800	return_std:                1.0792	target_mean:               5.5414	td_error_abs:              1.5109
test_return_mean:          0.6780	test_return_std:           0.7282	
[INFO 15:16:17] my_main Recent Stats | t_env:     230078 | Episode:     4603
epsilon:                   0.0500	grad_norm:                89.7469	loss:                      6.0538	q_taken_mean:              5.8444
return_mean:               1.6700	return_std:                1.0616	target_mean:               6.0737	td_error_abs:              1.4705
test_return_mean:          0.6780	test_return_std:           0.7282	
[INFO 15:16:32] my_main Recent Stats | t_env:     240078 | Episode:     4803
epsilon:                   0.0500	grad_norm:               127.4512	loss:                      7.0436	q_taken_mean:              6.6683
return_mean:               1.7600	return_std:                1.1209	target_mean:               6.7939	td_error_abs:              1.5323
test_return_mean:          0.6780	test_return_std:           0.7282	
Episode: 5000
[INFO 15:16:47] my_main Recent Stats | t_env:     250078 | Episode:     5003
epsilon:                   0.0500	grad_norm:               116.8961	loss:                      7.1138	q_taken_mean:              6.7320
return_mean:               1.8200	return_std:                1.0484	target_mean:               6.8008	td_error_abs:              1.5287
test_return_mean:          0.6780	test_return_std:           0.7282	
[INFO 15:16:47] my_main t_env: 250128 / 20050000
[INFO 15:16:47] my_main Estimated time left: 8 hours, 45 minutes, 2 seconds. Time passed: 6 minutes, 37 seconds
[INFO 15:17:06] my_main Recent Stats | t_env:     260078 | Episode:     5203
epsilon:                   0.0500	grad_norm:               105.2639	loss:                      7.2904	q_taken_mean:              7.1516
return_mean:               1.8100	return_std:                1.1816	target_mean:               7.0677	td_error_abs:              1.4757
test_return_mean:          1.0220	test_return_std:           0.9126	
[INFO 15:17:21] my_main Recent Stats | t_env:     270078 | Episode:     5403
epsilon:                   0.0500	grad_norm:               136.4894	loss:                      8.8043	q_taken_mean:              7.9113
return_mean:               1.9000	return_std:                1.1552	target_mean:               7.9144	td_error_abs:              1.5921
test_return_mean:          1.0220	test_return_std:           0.9126	
[INFO 15:17:36] my_main Recent Stats | t_env:     280078 | Episode:     5603
epsilon:                   0.0500	grad_norm:               147.5791	loss:                      9.5488	q_taken_mean:              8.1122
return_mean:               2.1400	return_std:                1.0774	target_mean:               8.0910	td_error_abs:              1.6838
test_return_mean:          1.0220	test_return_std:           0.9126	
[INFO 15:17:51] my_main Recent Stats | t_env:     290078 | Episode:     5803
epsilon:                   0.0500	grad_norm:               128.6379	loss:                      9.7595	q_taken_mean:              8.5202
return_mean:               1.8900	return_std:                1.0868	target_mean:               8.5453	td_error_abs:              1.6919
test_return_mean:          1.0220	test_return_std:           0.9126	
Episode: 6000
[INFO 15:18:06] my_main Recent Stats | t_env:     300078 | Episode:     6003
epsilon:                   0.0500	grad_norm:               122.7185	loss:                     10.0251	q_taken_mean:              8.8584
return_mean:               2.0500	return_std:                1.0882	target_mean:               8.8560	td_error_abs:              1.6157
test_return_mean:          1.0220	test_return_std:           0.9126	
[INFO 15:18:07] my_main t_env: 300128 / 20050000
[INFO 15:18:07] my_main Estimated time left: 8 hours, 46 minutes, 3 seconds. Time passed: 7 minutes, 57 seconds
[INFO 15:18:26] my_main Recent Stats | t_env:     310078 | Episode:     6203
epsilon:                   0.0500	grad_norm:               112.6664	loss:                     10.1290	q_taken_mean:              9.1111
return_mean:               2.1300	return_std:                1.1455	target_mean:               9.1435	td_error_abs:              1.5778
test_return_mean:          1.2560	test_return_std:           1.0464	
[INFO 15:18:41] my_main Recent Stats | t_env:     320078 | Episode:     6403
epsilon:                   0.0500	grad_norm:                79.5670	loss:                     10.1500	q_taken_mean:              9.5402
return_mean:               1.7800	return_std:                1.0596	target_mean:               9.4921	td_error_abs:              1.4768
test_return_mean:          1.2560	test_return_std:           1.0464	
[INFO 15:18:56] my_main Recent Stats | t_env:     330078 | Episode:     6603
epsilon:                   0.0500	grad_norm:               104.2578	loss:                     10.9914	q_taken_mean:             10.2329
return_mean:               1.7400	return_std:                1.1679	target_mean:              10.2825	td_error_abs:              1.5337
test_return_mean:          1.2560	test_return_std:           1.0464	
[INFO 15:19:11] my_main Recent Stats | t_env:     340078 | Episode:     6803
epsilon:                   0.0500	grad_norm:                92.4942	loss:                     10.8002	q_taken_mean:              9.9476
return_mean:               1.5900	return_std:                1.0778	target_mean:              10.0144	td_error_abs:              1.5235
test_return_mean:          1.2560	test_return_std:           1.0464	
Episode: 7000
[INFO 15:19:26] my_main Recent Stats | t_env:     350078 | Episode:     7003
epsilon:                   0.0500	grad_norm:               105.8417	loss:                     11.3432	q_taken_mean:             10.3528
return_mean:               1.2500	return_std:                0.9122	target_mean:              10.3629	td_error_abs:              1.5190
test_return_mean:          1.2560	test_return_std:           1.0464	
[INFO 15:19:26] my_main t_env: 350128 / 20050000
[INFO 15:19:26] my_main Estimated time left: 8 hours, 44 minutes, 8 seconds. Time passed: 9 minutes, 17 seconds
[INFO 15:19:46] my_main Recent Stats | t_env:     360078 | Episode:     7203
epsilon:                   0.0500	grad_norm:               116.3369	loss:                     11.8664	q_taken_mean:             10.5572
return_mean:               1.5400	return_std:                1.0609	target_mean:              10.6439	td_error_abs:              1.6015
test_return_mean:          1.4040	test_return_std:           1.1278	
[INFO 15:20:01] my_main Recent Stats | t_env:     370078 | Episode:     7403
epsilon:                   0.0500	grad_norm:               132.8133	loss:                     11.1715	q_taken_mean:             10.1005
return_mean:               1.0900	return_std:                0.9124	target_mean:              10.2405	td_error_abs:              1.6265
test_return_mean:          1.4040	test_return_std:           1.1278	
[INFO 15:20:16] my_main Recent Stats | t_env:     380078 | Episode:     7603
epsilon:                   0.0500	grad_norm:               102.6859	loss:                     11.3332	q_taken_mean:             10.5231
return_mean:               1.2800	return_std:                0.9637	target_mean:              10.6081	td_error_abs:              1.5641
test_return_mean:          1.4040	test_return_std:           1.1278	
[INFO 15:20:31] my_main Recent Stats | t_env:     390078 | Episode:     7803
epsilon:                   0.0500	grad_norm:               102.2221	loss:                     12.0052	q_taken_mean:             11.0272
return_mean:               1.0900	return_std:                0.9890	target_mean:              11.1661	td_error_abs:              1.6134
test_return_mean:          1.4040	test_return_std:           1.1278	
Episode: 8000
[INFO 15:20:46] my_main Recent Stats | t_env:     400078 | Episode:     8003
epsilon:                   0.0500	grad_norm:                90.8749	loss:                     12.4457	q_taken_mean:             11.4265
return_mean:               1.3800	return_std:                1.0345	target_mean:              11.6387	td_error_abs:              1.6849
test_return_mean:          1.4040	test_return_std:           1.1278	
[INFO 15:20:46] my_main t_env: 400128 / 20050000
[INFO 15:20:46] my_main Estimated time left: 8 hours, 44 minutes, 50 seconds. Time passed: 10 minutes, 37 seconds
[INFO 15:21:06] my_main Recent Stats | t_env:     410078 | Episode:     8203
epsilon:                   0.0500	grad_norm:                77.7225	loss:                     12.7903	q_taken_mean:             11.9472
return_mean:               1.1100	return_std:                1.0686	target_mean:              12.0934	td_error_abs:              1.5890
test_return_mean:          1.4520	test_return_std:           1.1239	
[INFO 15:21:21] my_main Recent Stats | t_env:     420078 | Episode:     8403
epsilon:                   0.0500	grad_norm:                58.5999	loss:                     13.3962	q_taken_mean:             12.4608
return_mean:               0.6400	return_std:                0.7598	target_mean:              12.5585	td_error_abs:              1.5329
test_return_mean:          1.4520	test_return_std:           1.1239	
[INFO 15:21:36] my_main Recent Stats | t_env:     430078 | Episode:     8603
epsilon:                   0.0500	grad_norm:                58.7904	loss:                     13.1189	q_taken_mean:             12.4376
return_mean:               0.6400	return_std:                0.8862	target_mean:              12.5240	td_error_abs:              1.5273
test_return_mean:          1.4520	test_return_std:           1.1239	
[INFO 15:21:51] my_main Recent Stats | t_env:     440078 | Episode:     8803
epsilon:                   0.0500	grad_norm:                58.1756	loss:                     13.4216	q_taken_mean:             12.7350
return_mean:               0.7100	return_std:                0.7690	target_mean:              12.7630	td_error_abs:              1.4461
test_return_mean:          1.4520	test_return_std:           1.1239	
Episode: 9000
[INFO 15:22:07] my_main Recent Stats | t_env:     450078 | Episode:     9003
epsilon:                   0.0500	grad_norm:                67.7246	loss:                     13.3066	q_taken_mean:             12.4482
return_mean:               0.3400	return_std:                0.5342	target_mean:              12.5146	td_error_abs:              1.4578
test_return_mean:          1.4520	test_return_std:           1.1239	
[INFO 15:22:07] my_main t_env: 450128 / 20050000
[INFO 15:22:07] my_main Estimated time left: 8 hours, 43 minutes, 41 seconds. Time passed: 11 minutes, 57 seconds
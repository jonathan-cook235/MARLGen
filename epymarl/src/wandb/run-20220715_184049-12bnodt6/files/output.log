
[2022-07-15 18:40:56.715] [info] No level specified, will use the first level described in the GDY.
[WARNING 18:40:56] my_main CUDA flag use_cuda was switched OFF automatically because no CUDA devices are available!
[INFO 18:40:56] my_main Experiment Parameters:
[INFO 18:40:56] my_main
{   'action_selector': 'epsilon_greedy',
    'add_value_last_step': True,
    'agent': 'rnn',
    'agent_output_type': 'q',
    'batch_size': 10,
    'batch_size_run': 1,
    'buffer_cpu_only': True,
    'buffer_size': 5000,
    'checkpoint_path': '',
    'critic_type': 'ac_critic',
    'double_q': True,
    'entropy_coef': 0.01,
    'env': 'griddlygen',
    'env_args': {   'seed': 2139},
    'epochs': 4,
    'eps_clip': 0.2,
    'epsilon_anneal_time': 5000,
    'epsilon_finish': 0.05,
    'epsilon_start': 1.0,
    'evaluate': False,
    'evaluation_epsilon': 0.0,
    'gamma': 0.99,
    'grad_norm_clip': 10,
    'hidden_dim': 64,
    'hypergroup': None,
    'hypernet_embed': 64,
    'hypernet_layers': 2,
    'label': 'default_label',
    'learner': 'q_learner',
    'learner_log_interval': 10000,
    'load_step': 0,
    'local_results_path': 'results',
    'log_interval': 10000,
    'lr': 0.0005,
    'mac': 'basic_mac',
    'mask_before_softmax': True,
    'max_before_softmax': True,
    'mixer': 'qmix',
    'mixing_embed_dim': 32,
    'name': 'qmix',
    'obs_agent_id': True,
    'obs_individual_obs': False,
    'obs_last_action': False,
    'optim_alpha': 0.99,
    'optim_eps': 1e-05,
    'q_nstep': 5,
    'repeat_id': 1,
    'runner': 'episode',
    'runner_log_interval': 1000,
    'save_model': False,
    'save_model_interval': 50000,
    'save_replay': False,
    'seed': 2139,
    'standardise_returns': False,
    'standardise_rewards': True,
    't_max': 20050000,
    'target_update_interval_or_tau': 200,
    'test_greedy': True,
    'test_interval': 50000,
    'test_nepisode': 100,
    'use_cuda': False,
    'use_rnn': False,
    'use_tensorboard': False}
[INFO 18:40:56] my_main Beginning training for 10000 episodes
[INFO 18:40:56] my_main t_env: 50 / 20050000
[INFO 18:40:56] my_main Estimated time left: 20 seconds. Time passed: 0 seconds
[INFO 18:41:16] my_main Recent Stats | t_env:      10016 | Episode:      202
epsilon:                   0.0500	grad_norm:                 1.1422	loss:                      0.8864	q_taken_mean:             -0.0579
return_mean:               0.3200	return_std:                0.4626	target_mean:              -0.0095	td_error_abs:              0.8647
test_return_mean:          0.0000	test_return_std:           0.0000	
[INFO 18:41:31] my_main Recent Stats | t_env:      20016 | Episode:      402
epsilon:                   0.0500	grad_norm:                 5.3947	loss:                      0.7398	q_taken_mean:             -0.0877
return_mean:               0.8000	return_std:                0.5419	target_mean:               0.0565	td_error_abs:              0.7475
test_return_mean:          0.0000	test_return_std:           0.0000	
[INFO 18:41:46] my_main Recent Stats | t_env:      30016 | Episode:      602
epsilon:                   0.0500	grad_norm:                 9.8412	loss:                      0.7677	q_taken_mean:              0.1507
return_mean:               1.6100	return_std:                0.6652	target_mean:               0.3372	td_error_abs:              0.7322
test_return_mean:          0.0000	test_return_std:           0.0000	
[INFO 18:42:02] my_main Recent Stats | t_env:      40016 | Episode:      802
epsilon:                   0.0500	grad_norm:                13.6682	loss:                      0.8109	q_taken_mean:              0.3312
return_mean:               1.9300	return_std:                0.4012	target_mean:               0.5491	td_error_abs:              0.7662
test_return_mean:          0.0000	test_return_std:           0.0000	
Episode: 1000
[INFO 18:42:17] my_main Recent Stats | t_env:      50016 | Episode:     1002
epsilon:                   0.0500	grad_norm:                21.5322	loss:                      1.0809	q_taken_mean:              0.6827
return_mean:               1.9300	return_std:                0.3834	target_mean:               0.9743	td_error_abs:              0.8781
test_return_mean:          0.0000	test_return_std:           0.0000	
[INFO 18:42:17] my_main t_env: 50066 / 20050000
[INFO 18:42:17] my_main Estimated time left: 8 hours, 56 minutes, 21 seconds. Time passed: 1 minutes, 20 seconds
[INFO 18:42:37] my_main Recent Stats | t_env:      60016 | Episode:     1202
epsilon:                   0.0500	grad_norm:                31.0694	loss:                      1.2982	q_taken_mean:              1.0788
return_mean:               2.1500	return_std:                0.2869	target_mean:               1.4632	td_error_abs:              0.9464
test_return_mean:          1.0000	test_return_std:           0.0000	
[INFO 18:42:52] my_main Recent Stats | t_env:      70016 | Episode:     1402
epsilon:                   0.0500	grad_norm:                35.7032	loss:                      1.5292	q_taken_mean:              1.6189
return_mean:               2.0400	return_std:                0.2903	target_mean:               2.0025	td_error_abs:              1.0272
test_return_mean:          1.0000	test_return_std:           0.0000	
[INFO 18:43:07] my_main Recent Stats | t_env:      80016 | Episode:     1602
epsilon:                   0.0500	grad_norm:                38.1120	loss:                      1.7416	q_taken_mean:              2.3697
return_mean:               2.0600	return_std:                0.5956	target_mean:               2.7502	td_error_abs:              1.0605
test_return_mean:          1.0000	test_return_std:           0.0000	
[INFO 18:43:22] my_main Recent Stats | t_env:      90016 | Episode:     1802
epsilon:                   0.0500	grad_norm:                42.5800	loss:                      2.1256	q_taken_mean:              3.1738
return_mean:               2.4200	return_std:                0.5159	target_mean:               3.5657	td_error_abs:              1.1079
test_return_mean:          1.0000	test_return_std:           0.0000	
Episode: 2000
[INFO 18:43:37] my_main Recent Stats | t_env:     100016 | Episode:     2002
epsilon:                   0.0500	grad_norm:                44.5008	loss:                      2.4068	q_taken_mean:              3.7709
return_mean:               2.5600	return_std:                0.5419	target_mean:               4.1435	td_error_abs:              1.1180
test_return_mean:          1.0000	test_return_std:           0.0000	
[INFO 18:43:37] my_main t_env: 100066 / 20050000
[INFO 18:43:37] my_main Estimated time left: 8 hours, 55 minutes, 15 seconds. Time passed: 2 minutes, 41 seconds
[INFO 18:43:57] my_main Recent Stats | t_env:     110016 | Episode:     2202
epsilon:                   0.0500	grad_norm:                47.8084	loss:                      2.8975	q_taken_mean:              4.3224
return_mean:               2.5700	return_std:                0.5029	target_mean:               4.6782	td_error_abs:              1.1738
test_return_mean:          1.3333	test_return_std:           0.0000	
[INFO 18:44:12] my_main Recent Stats | t_env:     120016 | Episode:     2402
epsilon:                   0.0500	grad_norm:                45.4473	loss:                      3.2993	q_taken_mean:              5.0817
return_mean:               2.7700	return_std:                0.3585	target_mean:               5.4192	td_error_abs:              1.1451
test_return_mean:          1.3333	test_return_std:           0.0000	
[INFO 18:44:27] my_main Recent Stats | t_env:     130016 | Episode:     2602
epsilon:                   0.0500	grad_norm:                52.0200	loss:                      4.0367	q_taken_mean:              5.5777
return_mean:               2.7800	return_std:                0.3386	target_mean:               5.9486	td_error_abs:              1.2553
test_return_mean:          1.3333	test_return_std:           0.0000	
[INFO 18:44:43] my_main Recent Stats | t_env:     140016 | Episode:     2802
epsilon:                   0.0500	grad_norm:                57.9799	loss:                      4.8533	q_taken_mean:              6.1449
return_mean:               2.8400	return_std:                0.4133	target_mean:               6.5394	td_error_abs:              1.3538
test_return_mean:          1.3333	test_return_std:           0.0000	
[INFO 18:44:58] my_main Recent Stats | t_env:     150016 | Episode:     3002
epsilon:                   0.0500	grad_norm:                66.8599	loss:                      5.8702	q_taken_mean:              6.7902
return_mean:               2.9200	return_std:                0.2272	target_mean:               7.2146	td_error_abs:              1.4690
test_return_mean:          1.3333	test_return_std:           0.0000	
[INFO 18:44:58] my_main t_env: 150066 / 20050000
[INFO 18:44:58] my_main Estimated time left: 8 hours, 52 minutes, 49 seconds. Time passed: 4 minutes, 1 seconds
Episode: 3000
[INFO 18:45:17] my_main Recent Stats | t_env:     160016 | Episode:     3202
epsilon:                   0.0500	grad_norm:                84.3257	loss:                      7.2511	q_taken_mean:              7.7034
return_mean:               2.6900	return_std:                0.3744	target_mean:               8.2132	td_error_abs:              1.6560
test_return_mean:          1.7500	test_return_std:           0.0000	
[INFO 18:45:33] my_main Recent Stats | t_env:     170016 | Episode:     3402
epsilon:                   0.0500	grad_norm:               100.2905	loss:                      8.4968	q_taken_mean:              8.3594
return_mean:               1.6600	return_std:                0.7992	target_mean:               8.9555	td_error_abs:              1.8598
test_return_mean:          1.7500	test_return_std:           0.0000	
[INFO 18:45:48] my_main Recent Stats | t_env:     180016 | Episode:     3602
epsilon:                   0.0500	grad_norm:                99.8922	loss:                      8.9553	q_taken_mean:              8.9785
return_mean:               2.6700	return_std:                0.4761	target_mean:               9.5564	td_error_abs:              1.8686
test_return_mean:          1.7500	test_return_std:           0.0000	
[INFO 18:46:03] my_main Recent Stats | t_env:     190016 | Episode:     3802
epsilon:                   0.0500	grad_norm:                87.3554	loss:                      8.9650	q_taken_mean:              9.1802
return_mean:               2.7400	return_std:                0.4166	target_mean:               9.6650	td_error_abs:              1.7592
test_return_mean:          1.7500	test_return_std:           0.0000	
[INFO 18:46:18] my_main Recent Stats | t_env:     200016 | Episode:     4002
epsilon:                   0.0500	grad_norm:                76.0540	loss:                      9.1990	q_taken_mean:              9.7415
return_mean:               2.6100	return_std:                0.4577	target_mean:              10.1495	td_error_abs:              1.6473
test_return_mean:          1.7500	test_return_std:           0.0000	
[INFO 18:46:18] my_main t_env: 200066 / 20050000
[INFO 18:46:18] my_main Estimated time left: 8 hours, 51 minutes, 43 seconds. Time passed: 5 minutes, 21 seconds
Episode: 4000
[INFO 18:46:38] my_main Recent Stats | t_env:     210016 | Episode:     4202
epsilon:                   0.0500	grad_norm:                53.5367	loss:                      8.7878	q_taken_mean:             10.0973
return_mean:               2.5500	return_std:                0.6047	target_mean:              10.3748	td_error_abs:              1.4159
test_return_mean:          2.0000	test_return_std:           0.0000	
[INFO 18:46:53] my_main Recent Stats | t_env:     220016 | Episode:     4402
epsilon:                   0.0500	grad_norm:                39.1977	loss:                      8.4906	q_taken_mean:             10.2993
return_mean:               2.9700	return_std:                0.0714	target_mean:              10.4937	td_error_abs:              1.2753
test_return_mean:          2.0000	test_return_std:           0.0000	
[INFO 18:47:08] my_main Recent Stats | t_env:     230016 | Episode:     4602
epsilon:                   0.0500	grad_norm:                30.8495	loss:                      8.5521	q_taken_mean:             10.4317
return_mean:               2.9800	return_std:                0.0872	target_mean:              10.5798	td_error_abs:              1.2067
test_return_mean:          2.0000	test_return_std:           0.0000	
[INFO 18:47:23] my_main Recent Stats | t_env:     240016 | Episode:     4802
epsilon:                   0.0500	grad_norm:                29.9199	loss:                      9.0588	q_taken_mean:             10.9787
return_mean:               2.8500	return_std:                0.2529	target_mean:              11.1263	td_error_abs:              1.2180
test_return_mean:          2.0000	test_return_std:           0.0000	
[INFO 18:47:39] my_main Recent Stats | t_env:     250016 | Episode:     5002
epsilon:                   0.0500	grad_norm:                30.4035	loss:                      9.1041	q_taken_mean:             11.0428
return_mean:               2.9100	return_std:                0.1872	target_mean:              11.1929	td_error_abs:              1.2212
test_return_mean:          2.0000	test_return_std:           0.0000	
[INFO 18:47:39] my_main t_env: 250066 / 20050000
[INFO 18:47:39] my_main Estimated time left: 8 hours, 51 minutes, 3 seconds. Time passed: 6 minutes, 42 seconds
Episode: 5000
[INFO 18:47:58] my_main Recent Stats | t_env:     260016 | Episode:     5202
epsilon:                   0.0500	grad_norm:                31.5410	loss:                      9.4128	q_taken_mean:             11.3071
return_mean:               1.0200	return_std:                1.2751	target_mean:              11.4584	td_error_abs:              1.2552
test_return_mean:          2.6000	test_return_std:           0.0000	
[INFO 18:48:14] my_main Recent Stats | t_env:     270016 | Episode:     5402
epsilon:                   0.0500	grad_norm:                40.9379	loss:                      9.5588	q_taken_mean:             11.7188
return_mean:               0.5900	return_std:                0.8045	target_mean:              11.9051	td_error_abs:              1.3044
test_return_mean:          2.6000	test_return_std:           0.0000	
[INFO 18:48:29] my_main Recent Stats | t_env:     280016 | Episode:     5602
epsilon:                   0.0500	grad_norm:                56.4906	loss:                      9.9973	q_taken_mean:             12.2522
return_mean:               1.0700	return_std:                0.7566	target_mean:              12.5005	td_error_abs:              1.3978
test_return_mean:          2.6000	test_return_std:           0.0000	
[INFO 18:48:44] my_main Recent Stats | t_env:     290016 | Episode:     5802
epsilon:                   0.0500	grad_norm:                85.5779	loss:                     10.6424	q_taken_mean:             12.7266
return_mean:               0.4800	return_std:                0.5320	target_mean:              13.0972	td_error_abs:              1.5705
test_return_mean:          2.6000	test_return_std:           0.0000	
Episode: 6000
[INFO 18:48:59] my_main Recent Stats | t_env:     300016 | Episode:     6002
epsilon:                   0.0500	grad_norm:               110.4083	loss:                     11.5332	q_taken_mean:             13.4050
return_mean:               0.3900	return_std:                0.6115	target_mean:              13.8599	td_error_abs:              1.7130
test_return_mean:          2.6000	test_return_std:           0.0000	
[INFO 18:48:59] my_main t_env: 300066 / 20050000
[INFO 18:48:59] my_main Estimated time left: 8 hours, 51 minutes, 51 seconds. Time passed: 8 minutes, 2 seconds
[INFO 18:49:19] my_main Recent Stats | t_env:     310016 | Episode:     6202
epsilon:                   0.0500	grad_norm:               167.1598	loss:                     13.3788	q_taken_mean:             13.9479
return_mean:               0.1900	return_std:                0.3051	target_mean:              14.6137	td_error_abs:              2.0779
test_return_mean:          2.2000	test_return_std:           0.0000	
[INFO 18:49:34] my_main Recent Stats | t_env:     320016 | Episode:     6402
epsilon:                   0.0500	grad_norm:               223.0275	loss:                     17.6037	q_taken_mean:             14.6154
return_mean:               0.0500	return_std:                0.1826	target_mean:              15.4712	td_error_abs:              2.4631
test_return_mean:          2.2000	test_return_std:           0.0000	
[INFO 18:49:50] my_main Recent Stats | t_env:     330016 | Episode:     6602
epsilon:                   0.0500	grad_norm:               253.9141	loss:                     19.9421	q_taken_mean:             15.3919
return_mean:               0.1300	return_std:                0.3822	target_mean:              16.3444	td_error_abs:              2.7155
test_return_mean:          2.2000	test_return_std:           0.0000	
[INFO 18:50:05] my_main Recent Stats | t_env:     340016 | Episode:     6802
epsilon:                   0.0500	grad_norm:               278.9300	loss:                     22.0040	q_taken_mean:             16.2119
return_mean:               0.0800	return_std:                0.2622	target_mean:              17.2300	td_error_abs:              2.8835
test_return_mean:          2.2000	test_return_std:           0.0000	
[INFO 18:50:20] my_main Recent Stats | t_env:     350016 | Episode:     7002
epsilon:                   0.0500	grad_norm:               333.0262	loss:                     25.2614	q_taken_mean:             17.0692
return_mean:               0.0500	return_std:                0.1586	target_mean:              18.2322	td_error_abs:              3.2166
test_return_mean:          2.2000	test_return_std:           0.0000	
[INFO 18:50:20] my_main t_env: 350066 / 20050000
[INFO 18:50:20] my_main Estimated time left: 8 hours, 51 minutes, 9 seconds. Time passed: 9 minutes, 23 seconds
Episode: 7000
[INFO 18:50:40] my_main Recent Stats | t_env:     360016 | Episode:     7202
epsilon:                   0.0500	grad_norm:               379.6623	loss:                     28.9877	q_taken_mean:             18.2006
return_mean:               0.0700	return_std:                0.2508	target_mean:              19.4503	td_error_abs:              3.4452
test_return_mean:          1.8000	test_return_std:           0.0000	
[INFO 18:50:55] my_main Recent Stats | t_env:     370016 | Episode:     7402
epsilon:                   0.0500	grad_norm:               458.5406	loss:                     33.7499	q_taken_mean:             19.4632
return_mean:               0.3500	return_std:                0.5813	target_mean:              20.8666	td_error_abs:              3.8229
test_return_mean:          1.8000	test_return_std:           0.0000	
[INFO 18:51:11] my_main Recent Stats | t_env:     380016 | Episode:     7602
epsilon:                   0.0500	grad_norm:               521.1834	loss:                     42.5466	q_taken_mean:             21.0711
return_mean:               0.0000	return_std:                0.0872	target_mean:              22.5908	td_error_abs:              4.3071
test_return_mean:          1.8000	test_return_std:           0.0000	
[INFO 18:51:26] my_main Recent Stats | t_env:     390016 | Episode:     7802
epsilon:                   0.0500	grad_norm:               634.8463	loss:                     53.3953	q_taken_mean:             22.7501
return_mean:               0.1700	return_std:                0.4806	target_mean:              24.4916	td_error_abs:              4.9737
test_return_mean:          1.8000	test_return_std:           0.0000	
[INFO 18:51:41] my_main Recent Stats | t_env:     400016 | Episode:     8002
epsilon:                   0.0500	grad_norm:               771.4661	loss:                     66.0320	q_taken_mean:             24.6721
return_mean:               0.0300	return_std:                0.1036	target_mean:              26.6383	td_error_abs:              5.6180
test_return_mean:          1.8000	test_return_std:           0.0000	
[INFO 18:51:41] my_main t_env: 400066 / 20050000
[INFO 18:51:41] my_main Estimated time left: 8 hours, 51 minutes, 12 seconds. Time passed: 10 minutes, 44 seconds
Episode: 8000
[INFO 18:52:01] my_main Recent Stats | t_env:     410016 | Episode:     8202
epsilon:                   0.0500	grad_norm:               1039.1086	loss:                     90.2963	q_taken_mean:             26.7475
return_mean:               0.0100	return_std:                0.0436	target_mean:              29.1082	td_error_abs:              6.5484
test_return_mean:          1.2000	test_return_std:           0.0000	
[INFO 18:52:16] my_main Recent Stats | t_env:     420016 | Episode:     8402
epsilon:                   0.0500	grad_norm:               1296.3246	loss:                    111.6365	q_taken_mean:             29.5714
return_mean:               0.1400	return_std:                0.1888	target_mean:              32.2703	td_error_abs:              7.4036
test_return_mean:          1.2000	test_return_std:           0.0000	
[INFO 18:52:32] my_main Recent Stats | t_env:     430016 | Episode:     8602
epsilon:                   0.0500	grad_norm:               1835.7863	loss:                    153.7119	q_taken_mean:             32.7185
return_mean:               1.0500	return_std:                0.3791	target_mean:              36.1650	td_error_abs:              8.9706
test_return_mean:          1.2000	test_return_std:           0.0000	
[INFO 18:52:47] my_main Recent Stats | t_env:     440016 | Episode:     8802
epsilon:                   0.0500	grad_norm:               2477.2180	loss:                    207.9235	q_taken_mean:             36.5286
return_mean:               1.2800	return_std:                0.5329	target_mean:              40.7072	td_error_abs:             10.5286
test_return_mean:          1.2000	test_return_std:           0.0000	
Episode: 9000
[INFO 18:53:02] my_main Recent Stats | t_env:     450016 | Episode:     9002
epsilon:                   0.0500	grad_norm:               2717.8279	loss:                    247.3370	q_taken_mean:             40.5198
return_mean:               1.1700	return_std:                0.7621	target_mean:              44.7656	td_error_abs:             11.1240
test_return_mean:          1.2000	test_return_std:           0.0000	
[INFO 18:53:02] my_main t_env: 450066 / 20050000
[INFO 18:53:02] my_main Estimated time left: 8 hours, 49 minutes, 5 seconds. Time passed: 12 minutes, 5 seconds
[INFO 18:53:22] my_main Recent Stats | t_env:     460016 | Episode:     9202
epsilon:                   0.0500	grad_norm:               2901.1518	loss:                    283.2543	q_taken_mean:             45.1471
return_mean:               0.8000	return_std:                0.9388	target_mean:              49.3182	td_error_abs:             11.6011
test_return_mean:          0.6000	test_return_std:           0.0000	
[INFO 18:53:37] my_main Recent Stats | t_env:     470016 | Episode:     9402
epsilon:                   0.0500	grad_norm:               3551.4716	loss:                    341.6533	q_taken_mean:             49.4370
return_mean:               0.2600	return_std:                0.5055	target_mean:              53.9633	td_error_abs:             12.6771
test_return_mean:          0.6000	test_return_std:           0.0000	
[INFO 18:53:53] my_main Recent Stats | t_env:     480016 | Episode:     9602
epsilon:                   0.0500	grad_norm:               4324.8285	loss:                    425.6136	q_taken_mean:             53.7711
return_mean:               0.3300	return_std:                0.4954	target_mean:              58.5719	td_error_abs:             13.6117
test_return_mean:          0.6000	test_return_std:           0.0000	
[INFO 18:54:08] my_main Recent Stats | t_env:     490016 | Episode:     9802
epsilon:                   0.0500	grad_norm:               4996.6932	loss:                    504.8787	q_taken_mean:             58.6331
return_mean:               0.2400	return_std:                0.4362	target_mean:              63.4513	td_error_abs:             14.3269
test_return_mean:          0.6000	test_return_std:           0.0000	
Episode: 10000
Exiting Main
Stopping all threads
Thread Thread-11 is alive! Is daemon: False
[INFO 18:54:23] my_main Finished Training
Exception ignored in: <function VideoRecorder.__del__ at 0x7ff0b2bfb050>
Traceback (most recent call last):
  File "/Users/jonnycook/opt/anaconda3/envs/MARLGen/lib/python3.7/site-packages/griddly/RenderTools.py", line 99, in __del__
    self.close()
  File "/Users/jonnycook/opt/anaconda3/envs/MARLGen/lib/python3.7/site-packages/griddly/RenderTools.py", line 95, in close
    self._image_encoder.close()
AttributeError: 'VideoRecorder' object has no attribute '_image_encoder'
Thread joined
Thread MsgRouterThr is alive! Is daemon: True
Thread joined
Thread QueueFeederThread is alive! Is daemon: True
Thread joined
Thread ChkStopThr is alive! Is daemon: True
Thread joined
Thread NetStatThr is alive! Is daemon: True
Thread joined
Thread Thread-50 is alive! Is daemon: True
Thread joined
Thread Thread-51 is alive! Is daemon: True
Thread joined
Thread Thread-52 is alive! Is daemon: True
Thread joined
Thread Thread-53 is alive! Is daemon: True
Thread joined
Thread Thread-54 is alive! Is daemon: True
Thread joined
Thread Thread-55 is alive! Is daemon: True
Thread joined
Exiting script
Seed: 5608
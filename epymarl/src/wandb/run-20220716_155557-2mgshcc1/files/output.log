about to run
setting up runner
namespace(action_selector='epsilon_greedy', add_value_last_step=True, agent='rnn', agent_output_type='q', batch_size=10, batch_size_run=1, buffer_cpu_only=True, buffer_size=5000, checkpoint_path='', critic_type='ac_critic', device='cpu', double_q=True, entropy_coef=0.01, env='griddlygen', env_args={'seed': 3673, 'level_seeds': array([1852, 6018, 2732, ..., 9042, 3067, 6654])}, epochs=4, eps_clip=0.2, epsilon_anneal_time=5000, epsilon_finish=0.05, epsilon_start=1.0, evaluate=False, evaluation_epsilon=0.0, gamma=0.99, grad_norm_clip=10, hidden_dim=64, hypergroup=None, hypernet_embed=64, hypernet_layers=2, label='default_label', learner='q_learner', learner_log_interval=10000, load_step=0, local_results_path='results', log_interval=10000, lr=0.0005, mac='basic_mac', mask_before_softmax=True, max_before_softmax=True, mixer='qmix', mixing_embed_dim=32, name='qmix', obs_agent_id=True, obs_individual_obs=False, obs_last_action=False, optim_alpha=0.99, optim_eps=1e-05, q_nstep=5, repeat_id=1, runner='episode', runner_log_interval=1000, save_model=False, save_model_interval=50000, save_replay=False, seed=3673, standardise_returns=False, standardise_rewards=True, t_max=20050000, target_update_interval_or_tau=200, test_greedy=True, test_interval=50000, test_nepisode=100, unique_token='qmix_seed3673_Griddly_2022-07-16 15:56:04.776832', use_cuda=False, use_rnn=False, use_tensorboard=False)
KWARGS
{'seed': 3673, 'level_seeds': array([1852, 6018, 2732, ..., 9042, 3067, 6654])}
[2022-07-16 15:56:04.799] [info] No level specified, will use the first level described in the GDY.
got runner
[WARNING 15:56:04] my_main CUDA flag use_cuda was switched OFF automatically because no CUDA devices are available!
[INFO 15:56:04] my_main Experiment Parameters:
[INFO 15:56:04] my_main
{   'action_selector': 'epsilon_greedy',
    'add_value_last_step': True,
    'agent': 'rnn',
    'agent_output_type': 'q',
    'batch_size': 10,
    'batch_size_run': 1,
    'buffer_cpu_only': True,
    'buffer_size': 5000,
    'checkpoint_path': '',
    'critic_type': 'ac_critic',
    'double_q': True,
    'entropy_coef': 0.01,
    'env': 'griddlygen',
    'env_args': {   'level_seeds': array([1852, 6018, 2732, ..., 9042, 3067, 6654]),
                    'seed': 3673},
    'epochs': 4,
    'eps_clip': 0.2,
    'epsilon_anneal_time': 5000,
    'epsilon_finish': 0.05,
    'epsilon_start': 1.0,
    'evaluate': False,
    'evaluation_epsilon': 0.0,
    'gamma': 0.99,
    'grad_norm_clip': 10,
    'hidden_dim': 64,
    'hypergroup': None,
    'hypernet_embed': 64,
    'hypernet_layers': 2,
    'label': 'default_label',
    'learner': 'q_learner',
    'learner_log_interval': 10000,
    'load_step': 0,
    'local_results_path': 'results',
    'log_interval': 10000,
    'lr': 0.0005,
    'mac': 'basic_mac',
    'mask_before_softmax': True,
    'max_before_softmax': True,
    'mixer': 'qmix',
    'mixing_embed_dim': 32,
    'name': 'qmix',
    'obs_agent_id': True,
    'obs_individual_obs': False,
    'obs_last_action': False,
    'optim_alpha': 0.99,
    'optim_eps': 1e-05,
    'q_nstep': 5,
    'repeat_id': 1,
    'runner': 'episode',
    'runner_log_interval': 1000,
    'save_model': False,
    'save_model_interval': 50000,
    'save_replay': False,
    'seed': 3673,
    'standardise_returns': False,
    'standardise_rewards': True,
    't_max': 20050000,
    'target_update_interval_or_tau': 200,
    'test_greedy': True,
    'test_interval': 50000,
    'test_nepisode': 100,
    'use_cuda': False,
    'use_rnn': False,
    'use_tensorboard': False}
[INFO 15:56:05] my_main Beginning training for 40000 episodes
/Users/jonnycook/Desktop/MARLGen/epymarl/src/components/episode_buffer.py:108: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  ../torch/csrc/utils/tensor_new.cpp:201.)
  v = th.tensor(v, dtype=dtype, device=self.device)
/Users/jonnycook/Desktop/MARLGen/epymarl/src/components/episode_buffer.py:108: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  v = th.tensor(v, dtype=dtype, device=self.device)
[INFO 15:56:05] my_main t_env: 50 / 20050000
[INFO 15:56:05] my_main Estimated time left: 48 seconds. Time passed: 0 seconds
[INFO 15:56:24] my_main Recent Stats | t_env:      10037 | Episode:      201
epsilon:                   0.0500	grad_norm:                 1.3654	loss:                      1.0025	q_taken_mean:              0.0803
return_mean:               0.0200	return_std:                0.4012	target_mean:               0.0843	td_error_abs:              0.6634
test_return_mean:          0.0100	test_return_std:           0.0995	
[INFO 15:56:39] my_main Recent Stats | t_env:      20078 | Episode:      402
epsilon:                   0.0500	grad_norm:                 2.9833	loss:                      0.6022	q_taken_mean:              0.0708
return_mean:               0.1529	return_std:                0.7215	target_mean:               0.1074	td_error_abs:              0.4395
test_return_mean:          0.0100	test_return_std:           0.0995	
[INFO 15:56:54] my_main Recent Stats | t_env:      30078 | Episode:      602
epsilon:                   0.0500	grad_norm:                15.4968	loss:                      1.4613	q_taken_mean:              0.1521
return_mean:               0.4900	return_std:                0.6987	target_mean:               0.3234	td_error_abs:              0.7048
test_return_mean:          0.0100	test_return_std:           0.0995	
[INFO 15:57:09] my_main Recent Stats | t_env:      40078 | Episode:      802
epsilon:                   0.0500	grad_norm:                15.7753	loss:                      1.2611	q_taken_mean:              0.1243
return_mean:               0.6500	return_std:                0.6782	target_mean:               0.2570	td_error_abs:              0.6813
test_return_mean:          0.0100	test_return_std:           0.0995	
Episode: 1000
[INFO 15:57:24] my_main t_env: 50078 / 20050000
[INFO 15:57:24] my_main Estimated time left: 8 hours, 49 minutes, 38 seconds. Time passed: 1 minutes, 19 seconds
[INFO 15:57:29] my_main Recent Stats | t_env:      50078 | Episode:     1002
epsilon:                   0.0500	grad_norm:                21.7876	loss:                      1.3048	q_taken_mean:              0.2254
return_mean:               0.8600	return_std:                0.8306	target_mean:               0.4141	td_error_abs:              0.7259
test_return_mean:          0.2600	test_return_std:           0.4068	
[INFO 15:57:44] my_main Recent Stats | t_env:      60078 | Episode:     1202
epsilon:                   0.0500	grad_norm:                33.7871	loss:                      1.4824	q_taken_mean:              0.5675
return_mean:               0.8100	return_std:                0.8040	target_mean:               0.8347	td_error_abs:              0.8088
test_return_mean:          0.2600	test_return_std:           0.4068	
[INFO 15:57:59] my_main Recent Stats | t_env:      70078 | Episode:     1402
epsilon:                   0.0500	grad_norm:                38.8924	loss:                      1.7919	q_taken_mean:              0.8906
return_mean:               0.9900	return_std:                0.8112	target_mean:               1.1760	td_error_abs:              0.9698
test_return_mean:          0.2600	test_return_std:           0.4068	
[INFO 15:58:14] my_main Recent Stats | t_env:      80078 | Episode:     1602
epsilon:                   0.0500	grad_norm:                43.2345	loss:                      1.6554	q_taken_mean:              1.1753
return_mean:               1.0100	return_std:                0.9348	target_mean:               1.4132	td_error_abs:              0.9383
test_return_mean:          0.2600	test_return_std:           0.4068	
[INFO 15:58:29] my_main Recent Stats | t_env:      90078 | Episode:     1802
epsilon:                   0.0500	grad_norm:                43.0675	loss:                      1.7278	q_taken_mean:              1.4411
return_mean:               1.0700	return_std:                0.9170	target_mean:               1.6839	td_error_abs:              0.9493
test_return_mean:          0.2600	test_return_std:           0.4068	
Episode: 2000
[INFO 15:58:44] my_main t_env: 100078 / 20050000
[INFO 15:58:44] my_main Estimated time left: 8 hours, 53 minutes, 51 seconds. Time passed: 2 minutes, 39 seconds
[INFO 15:58:49] my_main Recent Stats | t_env:     100078 | Episode:     2002
epsilon:                   0.0500	grad_norm:                37.8981	loss:                      1.7382	q_taken_mean:              1.6529
return_mean:               1.1700	return_std:                1.0841	target_mean:               1.8186	td_error_abs:              0.9387
test_return_mean:          0.4067	test_return_std:           0.5045	
[INFO 15:59:04] my_main Recent Stats | t_env:     110078 | Episode:     2202
epsilon:                   0.0500	grad_norm:                38.6227	loss:                      1.9982	q_taken_mean:              2.0719
return_mean:               1.2700	return_std:                1.0632	target_mean:               2.2297	td_error_abs:              0.9908
test_return_mean:          0.4067	test_return_std:           0.5045	
[INFO 15:59:19] my_main Recent Stats | t_env:     120078 | Episode:     2402
epsilon:                   0.0500	grad_norm:                38.5071	loss:                      2.0769	q_taken_mean:              2.4722
return_mean:               1.2900	return_std:                0.9586	target_mean:               2.6087	td_error_abs:              0.9584
test_return_mean:          0.4067	test_return_std:           0.5045	
[INFO 15:59:34] my_main Recent Stats | t_env:     130078 | Episode:     2602
epsilon:                   0.0500	grad_norm:                31.5645	loss:                      2.2339	q_taken_mean:              3.1191
return_mean:               1.1200	return_std:                0.9713	target_mean:               3.2199	td_error_abs:              0.9278
test_return_mean:          0.4067	test_return_std:           0.5045	
[INFO 15:59:50] my_main Recent Stats | t_env:     140078 | Episode:     2802
epsilon:                   0.0500	grad_norm:                38.6568	loss:                      2.7691	q_taken_mean:              3.4693
return_mean:               0.9600	return_std:                0.7869	target_mean:               3.5979	td_error_abs:              1.0347
test_return_mean:          0.4067	test_return_std:           0.5045	
Episode: 3000
[INFO 16:00:05] my_main t_env: 150078 / 20050000
[INFO 16:00:05] my_main Estimated time left: 8 hours, 51 minutes, 42 seconds. Time passed: 4 minutes, 0 seconds
[INFO 16:00:09] my_main Recent Stats | t_env:     150078 | Episode:     3002
epsilon:                   0.0500	grad_norm:                49.2853	loss:                      3.1374	q_taken_mean:              4.1471
return_mean:               1.2300	return_std:                1.0648	target_mean:               4.2203	td_error_abs:              1.0852
test_return_mean:          0.4700	test_return_std:           0.5759	
[INFO 16:00:24] my_main Recent Stats | t_env:     160078 | Episode:     3202
epsilon:                   0.0500	grad_norm:                42.9351	loss:                      3.5538	q_taken_mean:              4.6748
return_mean:               1.1500	return_std:                0.9977	target_mean:               4.6658	td_error_abs:              1.0315
test_return_mean:          0.4700	test_return_std:           0.5759	
[INFO 16:00:39] my_main Recent Stats | t_env:     170078 | Episode:     3402
epsilon:                   0.0500	grad_norm:                61.1688	loss:                      4.5950	q_taken_mean:              5.2884
return_mean:               1.1800	return_std:                0.8248	target_mean:               5.3240	td_error_abs:              1.1695
test_return_mean:          0.4700	test_return_std:           0.5759	
[INFO 16:00:55] my_main Recent Stats | t_env:     180078 | Episode:     3602
epsilon:                   0.0500	grad_norm:                65.0911	loss:                      4.7805	q_taken_mean:              5.3915
return_mean:               1.1000	return_std:                0.9228	target_mean:               5.4325	td_error_abs:              1.1971
test_return_mean:          0.4700	test_return_std:           0.5759	
[INFO 16:01:10] my_main Recent Stats | t_env:     190078 | Episode:     3802
epsilon:                   0.0500	grad_norm:                73.7705	loss:                      5.3217	q_taken_mean:              6.2219
return_mean:               1.2200	return_std:                1.1151	target_mean:               6.1957	td_error_abs:              1.2373
test_return_mean:          0.4700	test_return_std:           0.5759	
Episode: 4000
[INFO 16:01:25] my_main t_env: 200078 / 20050000
[INFO 16:01:25] my_main Estimated time left: 8 hours, 51 minutes, 24 seconds. Time passed: 5 minutes, 20 seconds
[INFO 16:01:30] my_main Recent Stats | t_env:     200078 | Episode:     4002
epsilon:                   0.0500	grad_norm:                68.3365	loss:                      6.0083	q_taken_mean:              6.9314
return_mean:               1.4000	return_std:                1.1125	target_mean:               6.9554	td_error_abs:              1.2701
test_return_mean:          0.5440	test_return_std:           0.6298	
[INFO 16:01:45] my_main Recent Stats | t_env:     210078 | Episode:     4202
epsilon:                   0.0500	grad_norm:                79.3710	loss:                      6.3310	q_taken_mean:              6.7377
return_mean:               1.3200	return_std:                0.9615	target_mean:               6.8111	td_error_abs:              1.3561
test_return_mean:          0.5440	test_return_std:           0.6298	
[INFO 16:02:00] my_main Recent Stats | t_env:     220078 | Episode:     4402
epsilon:                   0.0500	grad_norm:                64.2971	loss:                      5.9769	q_taken_mean:              6.7769
return_mean:               1.3600	return_std:                1.0083	target_mean:               6.7769	td_error_abs:              1.2578
test_return_mean:          0.5440	test_return_std:           0.6298	
[INFO 16:02:15] my_main Recent Stats | t_env:     230078 | Episode:     4602
epsilon:                   0.0500	grad_norm:                61.6960	loss:                      6.4039	q_taken_mean:              7.3306
return_mean:               1.1800	return_std:                0.9845	target_mean:               7.3349	td_error_abs:              1.2981
test_return_mean:          0.5440	test_return_std:           0.6298	
[INFO 16:02:30] my_main Recent Stats | t_env:     240078 | Episode:     4802
epsilon:                   0.0500	grad_norm:                60.3339	loss:                      6.3106	q_taken_mean:              7.2548
return_mean:               1.1900	return_std:                1.0559	target_mean:               7.3548	td_error_abs:              1.3210
test_return_mean:          0.5440	test_return_std:           0.6298	
Episode: 5000
[INFO 16:02:45] my_main t_env: 250078 / 20050000
[INFO 16:02:45] my_main Estimated time left: 8 hours, 50 minutes, 59 seconds. Time passed: 6 minutes, 40 seconds
[INFO 16:02:50] my_main Recent Stats | t_env:     250078 | Episode:     5002
epsilon:                   0.0500	grad_norm:                57.8264	loss:                      5.9659	q_taken_mean:              6.8109
return_mean:               1.3000	return_std:                1.0644	target_mean:               6.9314	td_error_abs:              1.3106
test_return_mean:          0.7760	test_return_std:           0.8198	
[INFO 16:03:05] my_main Recent Stats | t_env:     260078 | Episode:     5202
epsilon:                   0.0500	grad_norm:                64.0491	loss:                      5.7473	q_taken_mean:              6.9810
return_mean:               1.4100	return_std:                1.1538	target_mean:               7.1556	td_error_abs:              1.3216
test_return_mean:          0.7760	test_return_std:           0.8198	
[INFO 16:03:20] my_main Recent Stats | t_env:     270078 | Episode:     5402
epsilon:                   0.0500	grad_norm:                64.0481	loss:                      5.9815	q_taken_mean:              7.1425
return_mean:               1.5000	return_std:                0.9451	target_mean:               7.3440	td_error_abs:              1.3622
test_return_mean:          0.7760	test_return_std:           0.8198	
[INFO 16:03:35] my_main Recent Stats | t_env:     280078 | Episode:     5602
epsilon:                   0.0500	grad_norm:                67.2571	loss:                      6.3079	q_taken_mean:              6.9472
return_mean:               1.4000	return_std:                1.1184	target_mean:               7.1473	td_error_abs:              1.4262
test_return_mean:          0.7760	test_return_std:           0.8198	
[INFO 16:03:51] my_main Recent Stats | t_env:     290078 | Episode:     5802
epsilon:                   0.0500	grad_norm:                74.3391	loss:                      6.8114	q_taken_mean:              7.2791
return_mean:               1.5400	return_std:                1.1274	target_mean:               7.4906	td_error_abs:              1.4356
test_return_mean:          0.7760	test_return_std:           0.8198	
Episode: 6000
[INFO 16:04:06] my_main t_env: 300078 / 20050000
[INFO 16:04:06] my_main Estimated time left: 8 hours, 49 minutes, 24 seconds. Time passed: 8 minutes, 1 seconds
[INFO 16:04:10] my_main Recent Stats | t_env:     300078 | Episode:     6002
epsilon:                   0.0500	grad_norm:                80.0102	loss:                      7.8876	q_taken_mean:              7.8974
return_mean:               1.5900	return_std:                1.1004	target_mean:               8.1265	td_error_abs:              1.5443
test_return_mean:          0.8900	test_return_std:           0.8991	
[INFO 16:04:26] my_main Recent Stats | t_env:     310078 | Episode:     6202
epsilon:                   0.0500	grad_norm:                93.6215	loss:                      8.5758	q_taken_mean:              8.3563
return_mean:               1.1400	return_std:                0.9036	target_mean:               8.6060	td_error_abs:              1.6234
test_return_mean:          0.8900	test_return_std:           0.8991	
[INFO 16:04:41] my_main Recent Stats | t_env:     320078 | Episode:     6402
epsilon:                   0.0500	grad_norm:               106.5246	loss:                      9.0412	q_taken_mean:              8.7406
return_mean:               1.5200	return_std:                0.9773	target_mean:               8.9412	td_error_abs:              1.6449
test_return_mean:          0.8900	test_return_std:           0.8991	
[INFO 16:04:56] my_main Recent Stats | t_env:     330078 | Episode:     6602
epsilon:                   0.0500	grad_norm:               115.3259	loss:                      8.9795	q_taken_mean:              8.8951
return_mean:               1.4000	return_std:                1.0661	target_mean:               9.1660	td_error_abs:              1.6443
test_return_mean:          0.8900	test_return_std:           0.8991	
[INFO 16:05:11] my_main Recent Stats | t_env:     340078 | Episode:     6802
epsilon:                   0.0500	grad_norm:               113.0963	loss:                      8.9731	q_taken_mean:              8.8934
return_mean:               1.1300	return_std:                0.9705	target_mean:               9.1757	td_error_abs:              1.6710
test_return_mean:          0.8900	test_return_std:           0.8991	
Episode: 7000
[INFO 16:05:26] my_main t_env: 350078 / 20050000
[INFO 16:05:26] my_main Estimated time left: 8 hours, 49 minutes, 50 seconds. Time passed: 9 minutes, 21 seconds
[INFO 16:05:31] my_main Recent Stats | t_env:     350078 | Episode:     7002
epsilon:                   0.0500	grad_norm:               123.8348	loss:                      8.8007	q_taken_mean:              8.7867
return_mean:               1.1500	return_std:                1.0379	target_mean:               9.1332	td_error_abs:              1.7058
test_return_mean:          0.9420	test_return_std:           0.9589	
[INFO 16:05:46] my_main Recent Stats | t_env:     360078 | Episode:     7202
epsilon:                   0.0500	grad_norm:               109.5449	loss:                      8.5377	q_taken_mean:              8.7737
return_mean:               1.2600	return_std:                0.9261	target_mean:               8.9519	td_error_abs:              1.5753
test_return_mean:          0.9420	test_return_std:           0.9589	
[INFO 16:06:01] my_main Recent Stats | t_env:     370078 | Episode:     7402
epsilon:                   0.0500	grad_norm:                94.4714	loss:                      8.3508	q_taken_mean:              8.2393
return_mean:               1.2400	return_std:                0.9823	target_mean:               8.4309	td_error_abs:              1.5410
test_return_mean:          0.9420	test_return_std:           0.9589	
[INFO 16:06:17] my_main Recent Stats | t_env:     380078 | Episode:     7602
epsilon:                   0.0500	grad_norm:                82.7719	loss:                      8.3168	q_taken_mean:              8.5133
return_mean:               1.2100	return_std:                0.8950	target_mean:               8.6158	td_error_abs:              1.4769
test_return_mean:          0.9420	test_return_std:           0.9589	
[INFO 16:06:32] my_main Recent Stats | t_env:     390078 | Episode:     7802
epsilon:                   0.0500	grad_norm:                66.0306	loss:                      7.9736	q_taken_mean:              8.4119
return_mean:               1.0500	return_std:                0.8616	target_mean:               8.4054	td_error_abs:              1.3557
test_return_mean:          0.9420	test_return_std:           0.9589	
Episode: 8000
[INFO 16:06:47] my_main t_env: 400078 / 20050000
[INFO 16:06:47] my_main Estimated time left: 8 hours, 47 minutes, 52 seconds. Time passed: 10 minutes, 42 seconds
[INFO 16:06:52] my_main Recent Stats | t_env:     400078 | Episode:     8002
epsilon:                   0.0500	grad_norm:                54.3418	loss:                      7.8622	q_taken_mean:              8.6673
return_mean:               0.9800	return_std:                0.9187	target_mean:               8.5295	td_error_abs:              1.2248
test_return_mean:          0.9960	test_return_std:           0.9803	
[INFO 16:07:07] my_main Recent Stats | t_env:     410078 | Episode:     8202
epsilon:                   0.0500	grad_norm:                44.0460	loss:                      7.3922	q_taken_mean:              8.4743
return_mean:               1.1700	return_std:                0.9609	target_mean:               8.3351	td_error_abs:              1.1732
test_return_mean:          0.9960	test_return_std:           0.9803	
[INFO 16:07:22] my_main Recent Stats | t_env:     420078 | Episode:     8402
epsilon:                   0.0500	grad_norm:                49.6717	loss:                      7.3453	q_taken_mean:              9.0014
return_mean:               0.9900	return_std:                0.9235	target_mean:               8.9036	td_error_abs:              1.2277
test_return_mean:          0.9960	test_return_std:           0.9803	
[INFO 16:07:37] my_main Recent Stats | t_env:     430078 | Episode:     8602
epsilon:                   0.0500	grad_norm:                66.6988	loss:                      8.6140	q_taken_mean:              9.4998
return_mean:               0.9400	return_std:                0.8244	target_mean:               9.4880	td_error_abs:              1.3608
test_return_mean:          0.9960	test_return_std:           0.9803	
[INFO 16:07:53] my_main Recent Stats | t_env:     440078 | Episode:     8802
epsilon:                   0.0500	grad_norm:                73.9570	loss:                      9.5087	q_taken_mean:             10.0025
return_mean:               0.9900	return_std:                0.9550	target_mean:              10.0355	td_error_abs:              1.4485
test_return_mean:          0.9960	test_return_std:           0.9803	
Episode: 9000
[INFO 16:08:08] my_main t_env: 450078 / 20050000
[INFO 16:08:08] my_main Estimated time left: 8 hours, 47 minutes, 43 seconds. Time passed: 12 minutes, 3 seconds
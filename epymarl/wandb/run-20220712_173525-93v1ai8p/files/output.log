LEARNER
[2022-07-12 17:35:28.588] [[32minfo[39m] No level specified, will use the first level described in the GDY.
src/main.py:75: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3,and in 3.9 it will stop working
  if isinstance(v, collections.Mapping):
[INFO 17:35:28] root Saving to FileStorageObserver in results/sacred.
[DEBUG 17:35:28] pymarl Using capture mode "fd"
[INFO 17:35:28] pymarl Running command 'my_main'
[INFO 17:35:28] pymarl Started run with ID "34"
[DEBUG 17:35:28] pymarl Starting Heartbeat
[DEBUG 17:35:28] my_main Started
[WARNING 17:35:28] my_main CUDA flag use_cuda was switched OFF automatically because no CUDA devices are available!
[INFO 17:35:28] my_main Experiment Parameters:
[INFO 17:35:28] my_main
{   'action_selector': 'soft_policies',
    'add_value_last_step': True,
    'agent': 'rnn',
    'agent_output_type': 'pi_logits',
    'batch_size': 10,
    'batch_size_run': 10,
    'buffer_cpu_only': True,
    'buffer_size': 10,
    'checkpoint_path': '',
    'critic_type': 'ac_critic',
    'entropy_coef': 0.01,
    'env': 'griddlygen',
    'env_args': {   'seed': 1976},
    'epochs': 4,
    'eps_clip': 0.2,
    'epsilon_anneal_time': 5000,
    'epsilon_finish': 0.05,
    'epsilon_start': 1.0,
    'evaluate': False,
    'evaluation_epsilon': 0.0,
    'gamma': 0.99,
    'grad_norm_clip': 10,
    'hidden_dim': 64,
    'hypergroup': None,
    'hypernet_embed': 64,
    'hypernet_layers': 2,
    'label': 'default_label',
    'learner': 'actor_critic_learner',
    'learner_log_interval': 10000,
    'load_step': 0,
    'local_results_path': 'results',
    'log_interval': 50000,
    'lr': 0.0005,
    'mac': 'basic_mac',
    'mask_before_softmax': True,
    'max_before_softmax': True,
    'mixing_embed_dim': 32,
    'name': 'ia2c',
    'obs_agent_id': True,
    'obs_individual_obs': False,
    'obs_last_action': False,
    'optim_alpha': 0.99,
    'optim_eps': 1e-05,
    'q_nstep': 5,
    'repeat_id': 1,
    'runner': 'parallel',
    'runner_log_interval': 1000,
    'save_model': False,
    'save_model_interval': 50000,
    'save_replay': False,
    'seed': 1976,
    'standardise_returns': False,
    'standardise_rewards': True,
    't_max': 20050000,
    'target_update_interval_or_tau': 0.01,
    'test_greedy': True,
    'test_interval': 50000,
    'test_nepisode': 100,
    'use_cuda': False,
    'use_rnn': True,
    'use_tensorboard': False}
[INFO 17:35:28] my_main Beginning training for 20050000 timesteps
/Users/jonnycook/Desktop/MARLGen/epymarl/src/components/episode_buffer.py:108: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  ../torch/csrc/utils/tensor_new.cpp:201.)
  v = th.tensor(v, dtype=dtype, device=self.device)
/Users/jonnycook/Desktop/MARLGen/epymarl/src/components/episode_buffer.py:108: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  v = th.tensor(v, dtype=dtype, device=self.device)
[INFO 17:35:28] my_main t_env: 50 / 20050000
[INFO 17:35:28] my_main Estimated time left: 52 seconds. Time passed: 0 seconds
[INFO 17:36:41] my_main Recent Stats | t_env:      50006 | Episode:     1002
advantage_mean:            0.2951	agent_grad_norm:           0.3032	critic_grad_norm:          7.9779	critic_loss:              10.1539
pg_loss:                   0.3913	pi_max:                    0.6412	q_taken_mean:              9.9860	return_mean:               0.0000
return_std:                0.0000	target_mean:              10.2810	td_error_abs:              2.5836	test_return_mean:          0.1800
test_return_std:           0.7922	
[INFO 17:36:41] my_main t_env: 50056 / 20050000
[INFO 17:36:41] my_main Estimated time left: 8 hours, 2 minutes, 45 seconds. Time passed: 1 minutes, 12 seconds
[INFO 17:37:52] my_main Recent Stats | t_env:     100006 | Episode:     2002
advantage_mean:           -0.0840	agent_grad_norm:           0.0598	critic_grad_norm:          4.7928	critic_loss:               1.0079
pg_loss:                  -0.0452	pi_max:                    0.7704	q_taken_mean:             18.9137	return_mean:               1.9900
return_std:                0.0436	target_mean:              18.8297	td_error_abs:              0.5262	test_return_mean:          0.0900
test_return_std:           0.3961	
[INFO 17:37:52] my_main t_env: 100056 / 20050000
[INFO 17:37:52] my_main Estimated time left: 7 hours, 53 minutes, 22 seconds. Time passed: 2 minutes, 23 seconds
[INFO 17:39:04] my_main Recent Stats | t_env:     150006 | Episode:     3002
advantage_mean:           -0.0278	agent_grad_norm:           0.0774	critic_grad_norm:         28.4628	critic_loss:               0.5736
pg_loss:                   0.0529	pi_max:                    0.8459	q_taken_mean:             36.3487	return_mean:               2.0000
return_std:                0.0000	target_mean:              36.3209	td_error_abs:              0.4865	test_return_mean:          0.7233
test_return_std:           0.2972	
[INFO 17:39:04] my_main t_env: 150056 / 20050000
[INFO 17:39:04] my_main Estimated time left: 7 hours, 56 minutes, 1 seconds. Time passed: 3 minutes, 35 seconds
[INFO 17:40:17] my_main Recent Stats | t_env:     200006 | Episode:     4002
advantage_mean:           -0.0047	agent_grad_norm:           0.0161	critic_grad_norm:          0.4972	critic_loss:               0.0064
pg_loss:                  -0.0042	pi_max:                    0.8986	q_taken_mean:             41.0112	return_mean:               2.0000
return_std:                0.0000	target_mean:              41.0065	td_error_abs:              0.0511	test_return_mean:          1.0425
test_return_std:           0.2229	
[INFO 17:40:17] my_main t_env: 200056 / 20050000
[INFO 17:40:17] my_main Estimated time left: 8 hours, 6 minutes, 36 seconds. Time passed: 4 minutes, 49 seconds
[INFO 17:41:30] my_main Recent Stats | t_env:     250006 | Episode:     5002
advantage_mean:           -0.0009	agent_grad_norm:           0.0060	critic_grad_norm:          0.0862	critic_loss:               0.0006
pg_loss:                  -0.0041	pi_max:                    0.8222	q_taken_mean:             41.8325	return_mean:               2.0000
return_std:                0.0000	target_mean:              41.8316	td_error_abs:              0.0127	test_return_mean:          1.2340
test_return_std:           0.1783	
[INFO 17:41:30] my_main t_env: 250056 / 20050000
[INFO 17:41:30] my_main Estimated time left: 8 hours, 2 minutes, 48 seconds. Time passed: 6 minutes, 2 seconds
[INFO 17:42:42] my_main Recent Stats | t_env:     300006 | Episode:     6002
advantage_mean:            0.0009	agent_grad_norm:           0.0200	critic_grad_norm:          0.2107	critic_loss:               0.0132
pg_loss:                  -0.0069	pi_max:                    0.6904	q_taken_mean:             40.1623	return_mean:               2.0000
return_std:                0.0000	target_mean:              40.1632	td_error_abs:              0.0487	test_return_mean:          1.5980
test_return_std:           0.0199	
[INFO 17:42:42] my_main t_env: 300056 / 20050000
[INFO 17:42:42] my_main Estimated time left: 7 hours, 52 minutes, 13 seconds. Time passed: 7 minutes, 13 seconds
[INFO 17:43:55] my_main Recent Stats | t_env:     350006 | Episode:     7002
advantage_mean:           -0.0032	agent_grad_norm:           0.0414	critic_grad_norm:          0.5374	critic_loss:               0.0331
pg_loss:                  -0.0108	pi_max:                    0.6433	q_taken_mean:             37.7656	return_mean:               2.0000
return_std:                0.0000	target_mean:              37.7625	td_error_abs:              0.0746	test_return_mean:          1.9980
test_return_std:           0.0199	
[INFO 17:43:55] my_main t_env: 350056 / 20050000
[INFO 17:43:55] my_main Estimated time left: 8 hours, 32 seconds. Time passed: 8 minutes, 27 seconds
[INFO 17:45:07] my_main Recent Stats | t_env:     400006 | Episode:     8002
advantage_mean:            0.0003	agent_grad_norm:           0.0178	critic_grad_norm:          0.1364	critic_loss:               0.0074
pg_loss:                  -0.0053	pi_max:                    0.6682	q_taken_mean:             35.2384	return_mean:               2.0000
return_std:                0.0000	target_mean:              35.2387	td_error_abs:              0.0275	test_return_mean:          2.0000
test_return_std:           0.0000	
[INFO 17:45:07] my_main t_env: 400056 / 20050000
[INFO 17:45:07] my_main Estimated time left: 7 hours, 53 minutes, 14 seconds. Time passed: 9 minutes, 39 seconds
[INFO 17:46:19] my_main Recent Stats | t_env:     450018 | Episode:     9003
advantage_mean:            0.0203	agent_grad_norm:           0.0181	critic_grad_norm:          1.2799	critic_loss:               1.4295
pg_loss:                   0.0032	pi_max:                    0.7074	q_taken_mean:             24.7763	return_mean:               0.0000
return_std:                0.0000	target_mean:              24.7966	td_error_abs:              0.3005	test_return_mean:          2.0000
test_return_std:           0.0000	
[INFO 17:46:19] my_main t_env: 450068 / 20050000
[INFO 17:46:19] my_main Estimated time left: 7 hours, 50 minutes, 26 seconds. Time passed: 10 minutes, 51 seconds
[INFO 17:47:32] my_main Recent Stats | t_env:     500018 | Episode:    10003
advantage_mean:           -0.0071	agent_grad_norm:           0.0000	critic_grad_norm:          1.1319	critic_loss:               2.3430
pg_loss:                  -0.0000	pi_max:                    1.0000	q_taken_mean:            -69.0165	return_mean:               0.0000
return_std:                0.0000	target_mean:             -69.0236	td_error_abs:              0.7256	test_return_mean:          1.6000
test_return_std:           0.0000	
[INFO 17:47:32] my_main t_env: 500068 / 20050000
[INFO 17:47:32] my_main Estimated time left: 7 hours, 51 minutes, 5 seconds. Time passed: 12 minutes, 3 seconds
[INFO 17:48:44] my_main Recent Stats | t_env:     550018 | Episode:    11003
advantage_mean:           -0.0018	agent_grad_norm:           0.0000	critic_grad_norm:          4.9318	critic_loss:               0.3162
pg_loss:                  -0.0000	pi_max:                    1.0000	q_taken_mean:            -121.7293	return_mean:               0.0000
return_std:                0.0000	target_mean:             -121.7311	td_error_abs:              0.2670	test_return_mean:          1.2000
test_return_std:           0.0000	
[INFO 17:48:44] my_main t_env: 550068 / 20050000
[INFO 17:48:44] my_main Estimated time left: 7 hours, 49 minutes, 0 seconds. Time passed: 13 minutes, 15 seconds
[INFO 17:49:56] my_main Recent Stats | t_env:     600018 | Episode:    12003
advantage_mean:           -0.0013	agent_grad_norm:           0.0000	critic_grad_norm:          3.2250	critic_loss:               0.0278
pg_loss:                  -0.0000	pi_max:                    1.0000	q_taken_mean:            -139.7836	return_mean:               0.0000
return_std:                0.0000	target_mean:             -139.7849	td_error_abs:              0.0758	test_return_mean:          0.8000
test_return_std:           0.0000	
[INFO 17:49:56] my_main t_env: 600068 / 20050000
[INFO 17:49:56] my_main Estimated time left: 7 hours, 45 minutes, 33 seconds. Time passed: 14 minutes, 27 seconds
[INFO 17:51:07] my_main Recent Stats | t_env:     650018 | Episode:    13003
advantage_mean:            0.0147	agent_grad_norm:           0.0000	critic_grad_norm:          5.3019	critic_loss:               0.0025
pg_loss:                  -0.0000	pi_max:                    1.0000	q_taken_mean:            -142.0782	return_mean:               0.0000
return_std:                0.0000	target_mean:             -142.0634	td_error_abs:              0.0395	test_return_mean:          0.4000
test_return_std:           0.0000	
[INFO 17:51:07] my_main t_env: 650068 / 20050000
[INFO 17:51:07] my_main Estimated time left: 7 hours, 42 minutes, 45 seconds. Time passed: 15 minutes, 39 seconds
[INFO 17:52:19] my_main Recent Stats | t_env:     700018 | Episode:    14003
advantage_mean:           -0.0037	agent_grad_norm:           0.0000	critic_grad_norm:          3.5050	critic_loss:               0.0095
pg_loss:                  -0.0000	pi_max:                    1.0000	q_taken_mean:            -137.4452	return_mean:               0.0000
return_std:                0.0000	target_mean:             -137.4489	td_error_abs:              0.0534	test_return_mean:          0.0000
test_return_std:           0.0000	
[INFO 17:52:19] my_main t_env: 700068 / 20050000
[INFO 17:52:19] my_main Estimated time left: 7 hours, 42 minutes, 47 seconds. Time passed: 16 minutes, 50 seconds
[INFO 18:56:12] my_main Recent Stats | t_env:     750018 | Episode:    15003
advantage_mean:            0.0048	agent_grad_norm:           0.0000	critic_grad_norm:          2.9814	critic_loss:               0.0146
pg_loss:                  -0.0000	pi_max:                    1.0000	q_taken_mean:            -130.1781	return_mean:               0.0000
return_std:                0.0000	target_mean:             -130.1733	td_error_abs:              0.0632	test_return_mean:          0.0000
test_return_std:           0.0000	
[INFO 18:56:12] my_main t_env: 750068 / 20050000
[INFO 18:56:12] my_main Estimated time left: 17 days, 2 hours, 56 minutes, 45 seconds. Time passed: 1 hours, 20 minutes, 43 seconds
[INFO 22:54:09] my_main Recent Stats | t_env:     800018 | Episode:    16003
advantage_mean:           -0.0005	agent_grad_norm:           0.0000	critic_grad_norm:          2.7316	critic_loss:               0.0150
pg_loss:                  -0.0000	pi_max:                    1.0000	q_taken_mean:            -122.2503	return_mean:               0.0000
return_std:                0.0000	target_mean:             -122.2508	td_error_abs:              0.0604	test_return_mean:          0.0000
test_return_std:           0.0000	
[INFO 22:54:09] my_main t_env: 800068 / 20050000
[INFO 22:54:09] my_main Estimated time left: 63 days, 14 hours, 51 minutes, 40 seconds. Time passed: 5 hours, 18 minutes, 40 seconds
[INFO 05:07:21] my_main Recent Stats | t_env:     850018 | Episode:    17003
advantage_mean:           -0.0078	agent_grad_norm:           0.0000	critic_grad_norm:          2.6763	critic_loss:               0.0133
pg_loss:                  -0.0000	pi_max:                    1.0000	q_taken_mean:            -114.5927	return_mean:               0.0000
return_std:                0.0000	target_mean:             -114.6005	td_error_abs:              0.0516	test_return_mean:          0.0000
test_return_std:           0.0000	
[INFO 05:07:21] my_main t_env: 850068 / 20050000
[INFO 05:07:21] my_main Estimated time left: 99 days, 12 hours, 29 minutes, 24 seconds. Time passed: 11 hours, 31 minutes, 52 seconds
[INFO 08:43:09] my_main Recent Stats | t_env:     900018 | Episode:    18003
advantage_mean:           -0.0141	agent_grad_norm:           0.0000	critic_grad_norm:          4.2043	critic_loss:               0.0116
pg_loss:                  -0.0000	pi_max:                    1.0000	q_taken_mean:            -107.5822	return_mean:               0.0000
return_std:                0.0000	target_mean:             -107.5964	td_error_abs:              0.0515	test_return_mean:          0.0000
test_return_std:           0.0000	
[INFO 08:43:09] my_main t_env: 900068 / 20050000
